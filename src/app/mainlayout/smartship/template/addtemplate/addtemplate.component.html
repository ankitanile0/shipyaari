<div [innerHTML]="Loader"></div>
<app-toastr></app-toastr>
<div class="main-content">
   <div class="section">
      <div class="d-flex space-between align-items-center m-b-15">
         <div class="crumb">
           <!--  <h4>Template</h4> -->
            <!-- <ol class="breadcrumb p-0 m-b-0"> -->
              <!--  <li class="breadcrumb-item"><a href="javascript:" (click)="go_to_home()">Home</a></li>
               <li class="breadcrumb-item active" aria-current="page">Template</li> -->
               <!--  <div class="btn-group mb-3" role="group" aria-label="Basic example">
                  <button type="button" class="btn btn-secondary rad_0 dash_tab" (click)="go_to_template()">Template</button>
                  <button type="button" class="btn btn-secondary rad_0"  (click)="go_to_add_book()">Address Book</button>
                  <button type="button" class="btn btn-secondary rad_0"  (click)="go_to_module()">Module</button>
                  <button type="button" class="btn btn-secondary rad_0"  (click)="go_to_api_doc()">Api Documentation</button>
               </div> -->
            <!-- </ol> -->
             <div class="breadcrumb-new flat">
               <a href="javascript:" (click)="go_to_template()" class="active">Template</a>
               <a href="javascript:" (click)="go_to_add_book()" >Address Book</a>
               <a href="javascript:" (click)="go_to_module()" >Module</a>
               <a href="javascript:" (click)="go_to_api_doc()">Api Documentation</a>
            </div>
         </div>
      </div>
      <div class="row">
         <div class="col-lg-12">
            <alert></alert>
         </div>
      </div>
      <div class="row">
         <div class="col-lg-12">
            <div class="card">
               <div class="card-header">
                  <h4>Add Template</h4>
                  <div class="card-header-form">
                     <div class="form-check form-check-inline">
                        <button class="btn btn-primary " (click)="gototemplate()"> <i class="fas fa-arrow-left"></i> Back</button>
                     </div>
                     <div class="form-check form-check-inline">
                        <a href="javascript:void()" (click)="SyncProducts()" tooltip="Sync Products" > <i class="fas fa-sync fa-lg"></i> </a>
                     </div>
                  </div>
               </div>
               <form [formGroup]="template" (ngSubmit)="onSubmit()" autocomplete="off">
               <div class="card-body">
                  <div class="table-responsive">
                     <table class="table table-striped table-hover" id="save-stage" style="width:100%;">
                        <thead>
                           <tr>
                              <th width="15%">Template Name<span class="text-danger"> *</span></th>
                              <th width="15%">Product Description<span class="text-danger"> *</span></th>
                              <th width="10%">SKU<span class="text-danger"> </span></th>
                              <th width="10%">HSN<span class="text-danger"> </span></th>
                              <th width="7%">Price<span class="text-danger"> *</span></th>
                              <th width="7%">Quantity<span class="text-danger"> *</span></th>
                              <th width="7%">Tax(%)<span class="text-danger"> </span></th>
                              <th width="8%">Weight(KG's)<span class="text-danger"> *</span></th>
                              <th width="9%">Action</th>
                           </tr>
                        </thead>
                        <tbody formArrayName="templaterow" >
                           <tr  *ngFor=" let item of template.get('templaterow')['controls']; let i = index">
                              <ng-container [formGroupName]="i">
                                 <td>
                                    <input type="text" class="form-control" maxlength="50" formControlName="template_name">
                                    <div *ngIf="item['controls'].template_name.touched">
                                       <small class="text-danger" *ngIf="item['controls'].template_name?.errors?.required">Name Required</small>
                                    </div>
                                 </td>
                                 <td>
                                    <input type="text" class="form-control" maxlength="50" formControlName="prod_description">
                                    <div *ngIf="item['controls'].prod_description.touched">
                                       <small class="text-danger" *ngIf="item['controls'].prod_description?.errors?.required">Description Required</small>
                                    </div>
                                 </td>
                                 <td>
                                    <input type="text" class="form-control" maxlength="15" formControlName="template_sku">
                                    <div *ngIf="item['controls'].template_sku.touched">
                                       <small class="text-danger" *ngIf="item['controls'].template_sku?.errors?.required">SKU Required</small>
                                    </div>
                                 </td>
                                 <td>
                                    <input type="text" class="form-control" maxlength="12" formControlName="template_hsn" >
                                    <div *ngIf="item['controls'].template_hsn.touched">
                                       <small class="text-danger" *ngIf="item['controls'].template_hsn?.errors?.required">HSN Required</small>
                                       <small class="text-danger" *ngIf="item['controls'].template_hsn?.errors?.minLength">Minimum 8 Digits </small>
                                       <small class="text-danger" *ngIf="item['controls'].template_hsn?.errors?.minLength">maxLength 10 Digits </small>
                                    </div>
                                 </td>
                                 <td>
                                    <input type="text" class="form-control" maxlength="6" formControlName="template_price" >
                                    <div *ngIf="item['controls'].template_price.touched">
                                       <small class="text-danger" *ngIf="item['controls'].template_price?.errors?.required">Price Required</small>
                                       <small class="text-danger" *ngIf="item['controls'].template_quantity?.errors?.pattern">Enter valid Amount </small>
                                    </div>
                                 </td>
                                 <td>
                                    <input type="text" class="form-control" maxlength="4" formControlName="template_quantity" >
                                    <div *ngIf="item['controls'].template_quantity.touched">
                                       <small class="text-danger" *ngIf="item['controls'].template_quantity?.errors?.required">Qty Required</small>
                                       <small class="text-danger" *ngIf="item['controls'].template_quantity?.errors?.pattern">Enter valid Quantity </small>
                                    </div>
                                 </td>
                                 <td>
                                    <input type="text" class="form-control" maxlength="5" formControlName="template_tax" >
                                    <div *ngIf="item['controls'].template_tax.touched">
                                       <small class="text-danger" *ngIf="item['controls'].template_tax?.errors?.required">Tax % Required</small>
                                       <small class="text-danger" *ngIf="item['controls'].template_tax?.errors?.pattern">Enter valid Tax % </small>
                                    </div>
                                 </td>
                                 <td>
                                    <div class="input-group">
                                       <div class="input-group-prepend">
                                          <div class="input-group-text">
                                             <span>Kg</span>
                                          </div>
                                       </div>
                                       <input type="text" class="form-control" maxlength="3" formControlName="template_weight" >
                                    </div>
                                    <div *ngIf="item['controls'].template_weight.touched">
                                       <small class="text-danger" *ngIf="item['controls'].template_weight?.errors?.required">Weight Required</small>
                                       <!--  <small class="text-danger" *ngIf="item['controls'].template_weight?.errors?.pattern">Enter valid Weight </small> -->
                                    </div>
                                 </td>
                                 <td class="text-center">
                                    <a *ngIf="template.invalid == false" href="javascript:" class="temp-icons" tooltip="Add Row" (click)="addMainTable()" >
                                    <i class="fa fa-plus-circle text-success"></i></a> 
                                    <a *ngIf="template.invalid == true" href="javascript:" class="temp-icons" tooltip="Add Row"  >
                                    <i class="fa fa-plus-circle text-secondary"></i></a> 
                                    <a *ngIf="i!=0" href="javascript:" (click)="removeMainTable(i)" class="temp-icons" tooltip="Remove Row"  >
                                    <i class="fa fa-minus-circle text-danger"></i></a> 
                                    <!--  <a href="javascript" class="temp-icons" tooltip="Save Product">
                                       <i class="fa fa-save"></i></a> --> 
                                 </td>
                              </ng-container>
                           </tr>
                        </tbody>
                     </table>
                      </div>
                     <div class="row">
                        <div class="col">
                           <div class="align-right m-1">
                              <button type="submit" [disabled]="template.invalid" class="btn btn-primary m-1">Submit</button>
                              <button type="button" (click)="gototemplate()" class="btn btn-primary m-1">Cancel</button>
                           </div>
                        </div>
                     </div>
                  </div>
               </form>
            </div>
         </div>
      </div>
   </div>
</div>