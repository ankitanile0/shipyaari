<div [innerHTML]="Loader"></div>
<app-toastr></app-toastr>
<div class="main-content">
   <section class="section">
      <div class="d-flex space-between align-items-center m-b-15">
         <div class="crumb">
            <h4>Account History</h4>
            <!-- <ol class="breadcrumb p-0 m-b-0"> 
               <li class="breadcrumb-item"><a href="javascript:" (click)="go_to_home()">Home</a></li>
               <li class="breadcrumb-item active" aria-current="page">Passbook</li>
            </ol>-->
         </div>
      </div>
      <div class="row">
         <div class="col-lg-12">
            <alert></alert>
         </div>
      </div>
   
      <div class="row">
         <div class="col-lg-12">
            <div class="card">
               <div class="">
                  <div class="row p-2 m-1">
                     <div class="col-4 pb-2" style="border-right : 1px solid rgb(214, 214, 214) !important;" >
                        <div class="row">
                            <table class="table table-borderless text-left" style="border: 1px solid rgb(214 214 214 / 0%) !important; width: 100%">
                     
                            <tbody>
                              <tr>
                                <td class="table_td_30"><b>Parent ID</b></td>
                                <td class="w5">:</td>
                                <td >{{Parent}}</td>
                              </tr>
                              <tr>
                                <td class="table_td_30"><b>ID</b></td>
                                <td class="w5">:</td>
                                <td >{{Id}}</td>
                              </tr>
                              <tr>
                                <td class="table_td_30"><b>Name</b></td>
                                <td class="w5">:</td>
                                <td >{{Name}}</td>
                              </tr>
                              <tr>
                                <td class="table_td_30"><b>Email Id</b></td>
                                <td class="w5">:</td>
                                <td >{{email}}</td>
                              </tr>
                              <tr>
                                <td class="table_td_30"><b>Address</b></td>
                                <td class="w5">:</td>
                                <td >{{Address}}</td>
                              </tr>
                              <tr>
                                <td class="table_td_30"><b>GST No.</b></td>
                                <td class="w5">:</td>
                                <td >{{GST_No}}</td>
                              </tr>
                            </tbody>
                    </table>
                        </div>
                     </div>
                     <div class="col-4 pb-2" style="border-right : 1px solid rgb(214, 214, 214) !important;" >
                       <table class="table table-borderless text-left" style="border: 1px solid rgb(214 214 214 / 0%) !important; width: 100%">
                     
                      <tbody>
                        <tr>
                          <td class="table_td_40"><b>Unbill amount</b></td>
                          <td class="w5">:</td>
                          <td ><i class="fa fa-inr mr-1" aria-hidden="true"></i>{{Unbill_amount}}</td>
                        </tr>
                        <tr>
                          <td class="table_td_40"><b>Outsanding amount</b></td>
                          <td class="w5">:</td>
                          <td ><i class="fa fa-inr mr-1" aria-hidden="true"></i>{{Outsanding_amount}}</td>
                        </tr>
                        <tr>
                          <td class="table_td_40"><b>Wallet amount</b></td>
                          <td class="w5">:</td>
                          <td ><i class="fa fa-inr mr-1" aria-hidden="true"></i>{{Wallet_amount}}</td>
                        </tr>
                        <tr>
                          <td class="table_td_40"><b>Plan Opted</b></td>
                          <td class="w5">:</td>
                          <td >{{Plan_Opted}}</td>
                        </tr>
                        <tr>
                          <td class="table_td_40"><b>Deposit</b></td>
                          <td class="w5">:</td>
                          <td ><i class="fa fa-inr mr-1" aria-hidden="true"></i>{{Deposit}}</td>
                        </tr>
                        <tr>
                          <td class="table_td_40"><b>Total Amount paid</b></td>
                          <td class="w5">:</td>
                          <td ><i class="fa fa-inr mr-1" aria-hidden="true"></i>{{Total_Amount_paid}}</td>
                        </tr>
                      </tbody>
                    </table>
                       
                     </div>
                     <div class="col-4 pb-2 card_box" >
                      <table class="table table-borderless text-left" style="border: 1px solid rgb(214 214 214 / 0%) !important; width: 100%">
                     
                      <tbody>
                        <tr>
                          <td class="table_td_40"><b>Account Type</b></td>
                          <td class="w5">:</td>
                          <td>{{Account_Type == 2 ? 'Post Paid': 'Prepaid'}}</td>
                        </tr>
                        <tr>
                          <td class="table_td_40"><b>Account Open Date</b></td>
                          <td class="w5">:</td>
                          <td>{{Account_open_date}}</td>
                        </tr>
                        <tr>
                          <td class="table_td_40"><b>Account Expiry Date</b></td>
                          <td class="w5">:</td>
                          <td>{{Account_Expiry_Date}}</td>
                        </tr>
                        
                      </tbody>
                    </table>
                      <!--   <div class="row">
                           
                            
                           <div class="col-5">
                              <ul class="list-group">
                                 <li class="list-group-item pass_li">{{Account_Type == 2 ? 'Post Paid': 'Prepaid'}}</li>
                                 <li class="list-group-item pass_li">{{Account_open_date}}</li>
                                 <li class="list-group-item pass_li">{{Account_Expiry_Date}}</li>
                              </ul>
                           </div>
                        </div> -->
                     </div>
                      
                    
                  </div>
               </div>
            </div>
         </div>
      </div>
      <div class="row">
         <div class="col-lg-12">
            <div class="card">
               <div class="card-body p-0">
               <div class="card-header">
                  <h4>Template</h4>
                  <div class="card-header-form" style="margin-bottom: 12px;">
                     <div class="form-check form-check-inline">
                        <input type="text"placeholder="From Date To Date" class="form-control mt-1 mr-1" placement="left" bsDaterangepicker         
                           [bsConfig]="{showWeekNumbers: false, containerClass:'theme-dark-blue'}" [(ngModel)]="dRange" style="width:200px;">
                     </div>
                     <div class="form-check form-check-inline">
                        <button class="btn btn-primary mr-1" (click)="passbook_date_wise()">Search</button>
                     </div>
                     <div *ngIf="flag == 1" class="form-check form-check-inline">
                        <button class="btn btn-primary mr-1" (click)="export_date_wise()">Export</button>
                     </div>
                     <div  *ngIf="flag == 1" class="form-check form-check-inline">
                        <button class="btn btn-warning mr-1" (click)="reset_flag()">Reset Date</button>
                     </div>
                  </div>
               </div>
            </div>
               <div class="card-body">
                  <div class="table-responsive h-500 ">
                     <table class="table table-striped table-hover" id="save-stage" style="font-size: small;">
                        <thead class="text-center">
                           <tr>
                              <th style="width: 5%;">Sr No </th>
                              <th style="width: 11%;"> Date </th>
                              <th style="width: 20%;">Narration </th>
                              <th style="width: 8%;">Credited </th>
                              <th style="width: 10%;">Debited </th>
                              <th style="width: 10%;">Balance</th>
                              <th style="width: 10%;">Redeem Points</th>
                              <th style="width: 8%;">Slab Amt</th>
                              <th style="width: 9%;">Redeem Amt</th>
                               <th style="width: 8%; height:45px">Wallet Amt</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr *ngFor="let data of passbokList; let i = index;">
                              <td>{{i+1}}</td>
                              <td><button class="btn btn-outline-primary btn-sm" (click)="view_date_wise(transaction,data.date_list)" >{{data.date_list}}</button></td>
                              <td class="text-left"> {{data.narration}}</td>
                              <td class="text-left"><i class="fa fa-inr"> </i> {{data.credited}}</td>
                              <td class="text-left"><i class="fa fa-inr"> </i> {{data.debited}}</td>
                              <td class="text-left"><i class="fa fa-inr"> </i> {{data.balance}}</td>
                              <td>{{data.redeem_points}}</td>
                              <td class="text-left"> <i class="fa fa-inr"></i>  {{data.slab_amt}}</td>
                              <td class="text-left"> <i class="fa fa-inr"></i>  {{data.redeem_points_amt}}</td>
                              <td class="text-left"> <i class="fa fa-inr"></i>  {{data.wallet_amt}}</td>
                           </tr>
                           <tr *ngIf="passbokList == null || passbokList ==''">
                              <td colspan="10">
                                 <div class="col-lg-12 mt-5 mb-5 text-center">
                                    <img src="assets/img/alert.png">
                                    <p class="mb-0"><small>No data Found</small></p>

                                 </div>
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </section>
</div>




<ng-template #transaction>
   <div class="modal-header head-modal">
      <h5 class="modal-title" id="exampleModalLabel">{{sample_date}} - Transactions </h5>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="close_trans()"> 
      <span aria-hidden="true">&times;</span> 
      </button>
   </div>
   <div class="modal-body" >
      <div class=" table-responsive">
        <table class="table table-hover table-order" id="save-stage" style="width:100%;">
                    <thead>
                      <th>Sr.No</th>
                      <th style="width:22%">Date</th>
                      <th style="width:10%">Credited</th>
                      <th style="width:11%">Debited</th>
                      <th style="width:10%">Balance</th>
                      <th style="width:15%">Wallet Amt</th>
                      <th>Remark</th>
                    </thead>
                    <tbody >
                        <tr *ngFor ="let data of transaction_history_List; let i = index ">
                            <td>{{i+1}}</td>
                            <td>{{data.last_date}}</td>
                            <td> <i class="fa fa-inr"> </i> {{data.credited}}</td>
                            <td> <i class="fa fa-inr"> </i> {{data.debited}}</td>
                            <td> <i class="fa fa-inr"> </i> {{data.balance}}</td>
                            <td> <i class="fa fa-inr"> </i> {{data.wallet_amt}}</td>
                            <td>{{data.remark}}</td>
                        </tr>
                    </tbody>
                </table>
             </div>
   </div>
   <div class="modal-footer">
      <button type="button" (click)="close_trans()" class="btn btn-primary btn-sm m-1"> Close</button>
       
   </div>
</ng-template>